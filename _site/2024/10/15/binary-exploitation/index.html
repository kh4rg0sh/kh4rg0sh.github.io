<!DOCTYPE html>
<html lang="en-us">

  <script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>

<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Binary Exploitation 2024 &middot; kh4rg0sh Blog!
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <img src="/assets/content.png">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          kh4rg0sh Blog!
        </a>
      </h1>
      <p class="lead">You've just stumbled across a nerdy little corner of the internet. Come back soon to checkout more stuff as I keep updating the blog!</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
      
      
      
      
      
      
      <a class="sidebar-nav-item" href="/about/">About</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </nav>

    <p>&copy; 2026. All rights reserved.</p>
  </div>
</div>

    <div class="content container">
      <div class="post">
  <h1 class="post-title">Binary Exploitation 2024</h1>
  <span class="post-date">15 Oct 2024</span>
  <h1 id="introduction">Introduction</h1>
<p>motivated by this blog:</p>
<blockquote>
  <p><a href="https://ptr-yudai.hatenablog.com/entry/2019/07/01/143652" target="_blank">https://ptr-yudai.hatenablog.com/entry/2019/07/01/143652</a></p>
</blockquote>

<p>i’ll be attempting to do something similar. at the time of writing this doc, it’s already the mid of october. there’s not even 3 months left for this year to end. the goal of this challenge would be to upsolve all the pwn challenges that were introduced in alls the CTFs this year. since i’m a beginner (i started pwn seriously 2 months ago), i’ll only be attempting <code class="language-plaintext highlighter-rouge">C/C++ pwn</code> and that too i’ll stick to userland pwn only! the format of the challenge would be as follows:</p>
<ol>
  <li>mention the name, ctftime link and the archive link of the CTF.</li>
  <li>list down all the pwn category challenges in this doc.</li>
  <li>attempt each challenge for about 2 to 3 hours. if there’s some progress note that down. if there isn’t read a writeup and whatever new knowledge you’ve acquired should be introduced as a blog post on your blog.</li>
  <li>re-write the entire writeup in your own words. this also involves crafting the exploit script in your own style.</li>
  <li>if you are not able to provide a writeup for a challenge, mention the reason.</li>
  <li>an exception to not attempting a challenge would be in drastic conditions such as almost impossible to produce the environment in which the challenge was deployed, etc.</li>
  <li>every challenge should begin with a TLDR. this TLDR should mention the important techniques involved and the exploit path that you took.</li>
  <li>you should also rate challenges on the scale of <code class="language-plaintext highlighter-rouge">1 to 10</code></li>
</ol>

<h2 id="rating-scale">Rating Scale</h2>
<p>the difficulty rating scale that i propose here is a subject to change as per the requirements in the future. so these must be considered as tentative but the difficulty rating that i give to the problems would strictly follow whatever’s mentioned here.</p>

<ol>
  <li><strong>Difficulty = 1:</strong> very easy braindead pwn including bandit wargame type pwn challenges that do not require any exploitation knowledge apart from being able to use linux.</li>
  <li><strong>Difficulty = 2 - 4:</strong> ranging from trivial programming errors such as integer overflow, buffer overflow to writing trivial ROP chains and format string vulnerabilities to perform ret2win, ret2system, etc.</li>
  <li><strong>Difficulty = 5 - 6:</strong> Intermediate tasks such as partial overwrite of GOT/PLT entries and other techniques such as ret2csu, ret2dlresolve, etc.</li>
  <li><strong>Difficulty = 7 - 8:</strong> From SROP and introductory heap challenges to FSOP and targetting complex structures in the binary</li>
  <li><strong>Difficulty = 9 - 10:</strong> Challenges that are basically completely out of my league.</li>
</ol>

<hr />
<h1 id="irisctf-6th-jan-2024">IrisCTF [6th Jan, 2024]</h1>
<blockquote>
  <p>ctftime link: <a href="https://ctftime.org/event/2085" target="_blank">https://ctftime.org/event/2085</a><br />
archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/IrisCTF/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/IrisCTF/2024/pwn</a></p>
</blockquote>

<ul>
  <li>comments: overall very nice challenges. loved these.
    <h2 id="insanity-check">Insanity-Check</h2>
  </li>
  <li>
    <h3 id="difficulty-210">Difficulty: 2/10</h3>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: ret2win just get the right offsets and the printed message aligns with the target.
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/insanity-check" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/insanity-check</a></p>
</blockquote>

<ul>
  <li>comments: the problem is kinda dumb imo, but this problem showcases an interesting aspect to challenge authors pertaining to crafting custom addresses for functions. i wonder how did they manage to do this.
    <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">__attribute__</span><span class="p">((</span><span class="n">section</span><span class="p">(</span><span class="s">".flag"</span><span class="p">)))</span>
<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">__asm__</span><span class="p">(</span><span class="s">"pop %rdi"</span><span class="p">);</span>
  <span class="n">system</span><span class="p">(</span><span class="s">"cat /flag"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>    </div>
    <p>believe it or not, this <code class="language-plaintext highlighter-rouge">win()</code> function is at a very funny memory address <code class="language-plaintext highlighter-rouge">0x6d6f632e</code> which translates to <code class="language-plaintext highlighter-rouge">.com</code> in little endian.</p>
  </li>
</ul>

<h2 id="serious-banking">Serious Banking</h2>
<ul>
  <li>
    <h3 id="difficulty-510">Difficulty: 5/10</h3>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: `C++ pwn` with signed char negative indexing leveraging to a format string vulnerability to leak libc address and then `ret2system`.
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/serious-banking" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/serious-banking</a></p>
</blockquote>

<ul>
  <li>comments: i expected this challenge to be based on some <code class="language-plaintext highlighter-rouge">C++ STL</code> vulnerability. however, it turns out that the vulnerability was the usage of <code class="language-plaintext highlighter-rouge">signed char</code> in indexing. nevertheless, this is still an interesting challenge. this is the second time im witnessing brutally ripping off program control flow due to a mere <code class="language-plaintext highlighter-rouge">signed char</code> indexing.</li>
</ul>

<p>also i found the path to <code class="language-plaintext highlighter-rouge">ret2system</code> kinda innovative in this problem. the stack frame deallocation assembly looked somewhat like</p>

<pre><code class="language-asm">0x0000000000001812 &lt;+1426&gt;:  add    rsp,0x38
0x0000000000001816 &lt;+1430&gt;:  pop    rbx
0x0000000000001817 &lt;+1431&gt;:  pop    r12
0x0000000000001819 &lt;+1433&gt;:  pop    r13
0x000000000000181b &lt;+1435&gt;:  pop    r14
0x000000000000181d &lt;+1437&gt;:  pop    r15
0x000000000000181f &lt;+1439&gt;:  pop    rbp
0x0000000000001820 &lt;+1440&gt;:  ret
</code></pre>
<p>so instead of <code class="language-plaintext highlighter-rouge">pop rdi; &lt;bin_sh&gt;; system;</code> i did <code class="language-plaintext highlighter-rouge">mov rdi, r12; call rbx;</code> and since we already control the <code class="language-plaintext highlighter-rouge">r12</code> and <code class="language-plaintext highlighter-rouge">rbx</code> register, this still paves its way to <code class="language-plaintext highlighter-rouge">ret2system</code>.</p>

<h2 id="memory-not-solved">Memory [Not Solved]</h2>
<p>a <code class="language-plaintext highlighter-rouge">kernel</code> pwn. im not attempting these right now.</p>

<h2 id="sequilitis-not-solved">Sequilitis [Not Solved]</h2>
<p>this challenge is related to <code class="language-plaintext highlighter-rouge">sqlite3</code> pwning. im not attempting this right now.</p>

<hr />
<h1 id="uoftctf-13th-jan-2024">UofTCTF [13th Jan, 2024]</h1>
<blockquote>
  <p>ctftime link: <a href="https://ctftime.org/event/2219" target="_blank">https://ctftime.org/event/2219</a><br />
archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/UofTCTF/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/UofTCTF/2024/pwn</a></p>
</blockquote>

<h2 id="basic-overflow">Basic Overflow</h2>
<ul>
  <li>
    <h3 id="difficulty-110">Difficulty: 1/10</h3>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: simple ret2win
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/basic_overflow" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/basic_overflow</a></p>
</blockquote>

<ul>
  <li>comments: this is too stupid to be a CTF challenge. hate this.</li>
</ul>

<h2 id="baby-shellcode">Baby Shellcode</h2>
<ul>
  <li>
    <h3 id="difficulty-110-1">Difficulty: 1/10</h3>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: read into the stack and `jmp, rsp`. write a trivial shellcode.
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/baby_shellcode" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/baby_shellcode</a></p>
</blockquote>

<ul>
  <li>comments: a really dumb challenge. i regret solving this.</li>
</ul>

<h2 id="patched-shell">Patched Shell</h2>
<ul>
  <li>
    <h3 id="difficulty-210-1">Difficulty: 2/10</h3>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: ret2win with stack misalignment
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/patched_shell" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/patched_shell</a></p>
</blockquote>

<ul>
  <li>comments: too standard to be a CTF challenge in my opinion.</li>
</ul>

<h2 id="nothing-to-return">Nothing to Return</h2>
<ul>
  <li>
    <h3 id="difficulty-210-2">Difficulty: 2/10</h3>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: straightforward ret2system
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/nothing_to_return" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/nothing_to_return</a></p>
</blockquote>

<ul>
  <li>comments: again too straightforward. overall i feel like the pwn challenges in this CTF are just too dumb. what a waste of time.</li>
</ul>

<hr />
<h1 id="hkust-firebird-ctf-20th-jan-2024">HKUST Firebird CTF [20th Jan, 2024]</h1>
<blockquote>
  <p>ctftime link: <a href="https://ctftime.org/event/2225" target="_blank">https://ctftime.org/event/2225</a><br />
archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/HKUSTFirebird/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/HKUSTFirebird/2024/pwn</a><br />
website: <a href="https://ash.firebird.sh/challenges" target="_blank">https://ash.firebird.sh/challenges</a></p>
</blockquote>

<ul>
  <li>comments: overall high quality challenges. totally recommended to solve!
    <h2 id="moonblast">MoonBlast</h2>
  </li>
  <li>
    <h3 id="difficulty-310">Difficulty: 3/10</h3>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: rand() simulation. ROP to obtain a libc leak via `puts(GOT[puts])` then ret2system
</code></pre></div></div>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/MoonBlast" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/MoonBlast</a></p>
</blockquote>

<ul>
  <li>comments: i liked the part of having to write a local program that would generate the right passcode to pass the protection. apart from that, this was a pretty standard libc leak via ropping and abusing the PLT entries to ret2system. pretty standard.</li>
</ul>

<h2 id="mercuryblast">MercuryBlast</h2>
<ul>
  <li>
    <h3 id="difficulty-610">Difficulty: 6/10</h3>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: UAF + heapoverflow =&gt; tcache poisoning and overwrite `__free_hook`.
</code></pre></div></div>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/MercuryBlast" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/MercuryBlast</a></p>
</blockquote>

<ul>
  <li>comments: awesome challenge! this was fun. this was the first time i performed a <code class="language-plaintext highlighter-rouge">tcache poisoning</code> attack without any external help. the vulnerability was evident, but it was a great learning experience. recommended challenge for introductory heap exploitation! i, myself, learnt a couple of things while playing around devising strategies to attack this program.</li>
</ul>

<h2 id="mpi-unsolved">mpi [Unsolved]</h2>
<p>attempting: no clue yet</p>

<h2 id="unsetenv-unsolved">unsetenv [Unsolved]</h2>
<p>attempting: no clue yet</p>

<h2 id="uwuof-super-arm-deluxe-edition-not-solved">UwUOF+++ Super ARM Deluxe Edition [Not Solved]</h2>
<p>ARM binary. not pwning different target architecture binaries right now atleast. save these for the future.</p>

<h2 id="trim-not-solved">trim [Not Solved]</h2>
<p>this is a lua pwn challenge. currently, im not dealing with these types of challenges. save these for the future.</p>

<hr />

<h1 id="insomnihack-teaser-20th-jan-2024">Insomni’Hack Teaser [20th Jan, 2024]</h1>
<blockquote>
  <p>ctftime link: <a href="https://ctftime.org/event/2139" target="_blank">https://ctftime.org/event/2139</a><br />
archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/insomnihack/2024/Quals/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/insomnihack/2024/Quals/pwn</a></p>
</blockquote>

<p>comments: okayish challenges.</p>

<h2 id="vaulty">Vaulty</h2>
<ul>
  <li>
    <h3 id="difficulty--310">Difficulty = 3/10</h3>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: format string and buffer overflow =&gt; obtain libc leak, elf leak and canary leak =&gt; ROP to ret2system
</code></pre></div></div>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/Vaulty" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/Vaulty</a></p>
</blockquote>

<ul>
  <li>comments: pretty standard challenge that exploits format string vulnerability. didn’t learn anything new tbh. recommended to beginners, however!</li>
</ul>

<h2 id="tinderbox-not-solved">Tinderbox [Not Solved]</h2>
<p>wasm pwn challenge. wont be solving this now. ill save this up for future when i touch browser pwn.</p>

<hr />
<h1 id="mapna-ctf-20th-jan-2024">Mapna CTF [20th Jan, 2024]</h1>
<blockquote>
  <p>ctftime link: <a href="https://ctftime.org/event/2205" target="_blank">https://ctftime.org/event/2205</a><br />
archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/Mapna/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/Mapna/2024/pwn</a></p>
</blockquote>

<h2 id="ninipwn">ninipwn</h2>
<ul>
  <li>
    <h3 id="difficulty-310-1">Difficulty: 3/10</h3>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: global variable overflow + format string bug =&gt; ret2win
</code></pre></div></div>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/ninipwn" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/ninipwn</a></p>
</blockquote>

<ul>
  <li>comments: kinda creative problem. i found out the format string bug. it was very evident to be honest however that kinda lead me in the wrong direction. i was trying to somehow overwrite the last byte of the return address using the format string but it felt impossible. that’s when i noticed there was another bug, the overflow in the global variables in the data section. that was kinda unexpected and creative. nice challenge.</li>
</ul>

<h2 id="buggy-paint">Buggy Paint</h2>
<ul>
  <li>
    <h3 id="difficulty-710">Difficulty: 7/10</h3>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: Use After Free =&gt; leak heap, libc and stack =&gt; tcache poisoning to obtain arbitary read and write =&gt; ROP chain on the stack to perform ret2system
</code></pre></div></div>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/Buggy_Paint" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/Buggy_Paint</a></p>
</blockquote>

<ul>
  <li>comments: awesome challenge! the challenge premise didn’t feel forced for a pwning challenge. with all the security mitigations enabled and a fully functional paint application, the bug (use after free) in the program did not feel intentional. very realistic premise, a bug that a novice programmer would definitely commit.</li>
</ul>

<p>also this was the first time i exploited a heap challenge that used the <code class="language-plaintext highlighter-rouge">libc ver. 2.35</code>. so this was very educational. also i believe that there are other exploitation paths to exploit this program as well. i read a writeup that involved FSOP. so that’s something id like to look into the future.</p>

<p>overall a recommended challenge for heap exploitation novices who want familiarity with exploiting programs in <code class="language-plaintext highlighter-rouge">libc 2.35</code></p>

<h2 id="protector-unsolved">Protector [Unsolved]</h2>
<p>trying to think of an exploit. right now, the only thing i can think of is ORW using ROP. but my ROP chain is longer than what they per</p>

<h2 id="u2s-not-solved">U2S [Not Solved]</h2>
<p>this is a <code class="language-plaintext highlighter-rouge">lua</code> pwn challenge. ill do these later. leaving this challenge for now, not attempting.</p>

<hr />

<h1 id="0xl4ugh-ctf-9th-feb-2024">0xL4ugh CTF [9th Feb, 2024]</h1>
<blockquote>
  <p>ctftime link: <a href="https://ctftime.org/event/2216" target="_blank">https://ctftime.org/event/2216</a>&lt;/br&gt;
archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/0xL4ugh/2024/pwn/pwn1" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/0xL4ugh/2024/pwn/pwn1</a></p>
</blockquote>

<p>comments: only 1 pwn challenge on this ctf. cakewalk challenge honestly.</p>

<h2 id="pwn1">pwn1</h2>
<ul>
  <li>
    <h3 id="difficulty-410">Difficulty: 4/10</h3>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>summary: UAF =&gt; tcache poisoning to overwrite free_hook with system
</code></pre></div></div>

<blockquote>
  <p>writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/pwn1" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/pwn1</a></p>
</blockquote>

<ul>
  <li>comments: pretty standard challenge and in my opinion, a very poorly written challenge. even though, im suppose to be rating heap challenges atleast a <code class="language-plaintext highlighter-rouge">6/10</code> but this challenge felt pretty stupid. i dont know if it’s either the challenge’s fault or if i’m getting better, but this was really straightforward. i’ve performed <code class="language-plaintext highlighter-rouge">tcache poisoning</code> on <code class="language-plaintext highlighter-rouge">libc 2.31</code> in a very similar setup (or maybe a bit more constrained setting) as this challenge so this didn’t feel difficult at all. hence, i’m rating this <code class="language-plaintext highlighter-rouge">4/10</code>. what a no brainer!</li>
</ul>

<hr />

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2024/12/25/backdoorctf-2024/">
            BackdoorCTF 2024
            <small>25 Dec 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2024/10/06/elf-golfing/">
            ELF Golfing
            <small>06 Oct 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2024/02/03/branching-pruning/">
            Branching and Pruning
            <small>03 Feb 2024</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
