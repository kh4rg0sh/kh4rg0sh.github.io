<!DOCTYPE html>
<html lang="en-us">

  <script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']]
    },
    svg: { fontCache: 'global' }
  };
</script>

<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      BackdoorCTF 2023 &middot; kh4rg0sh Blog!
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <img src="/assets/content.png">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          kh4rg0sh Blog!
        </a>
      </h1>
      <p class="lead">You've just stumbled across a nerdy little corner of the internet. Come back soon to checkout more stuff as I keep updating the blog!</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
      
      
      
      
      
      
      <a class="sidebar-nav-item" href="/about/">About</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
    </nav>

    <p>&copy; 2026. All rights reserved.</p>
  </div>
</div>

    <div class="content container">
      <div class="post">
  <h1 class="post-title">BackdoorCTF 2023</h1>
  <span class="post-date">19 Dec 2023</span>
  <style>
.gist-collapsed {
  max-height: 9rem;
  overflow: hidden;
  position: relative;
  margin-bottom: 1rem;
}

.gist-collapsed::after {
  content: "Show more";
  position: absolute;
  bottom: 0;
  right: 0;
  padding: 6px 10px;
  background: linear-gradient(to right, transparent, #fff);
  cursor: pointer;
  font-size: 0.9em;
  color: #555;
}

.gist-expanded {
  max-height: none;
}

.gist-expanded::after {
  content: "Show less";
}
</style>

<script>
document.addEventListener("click", e => {
  const box = e.target.closest(".gist-collapsed");
  if (!box) return;
  box.classList.toggle("gist-expanded");
});
</script>

<p>InfosecIITR hosted the annual CTF, “Backdoor CTF,” which ran for an impressive <code class="language-plaintext highlighter-rouge">48</code> hours, starting from the <code class="language-plaintext highlighter-rouge">16th of December</code> to the <code class="language-plaintext highlighter-rouge">18th of December</code>. This was the first time I participated as a CTF organizer and a problem setter. Also, it was a huge event this time, with approximately <code class="language-plaintext highlighter-rouge">1300 teams</code> registering and <code class="language-plaintext highlighter-rouge">800 teams</code> having a non-zero score. I was anxious as well as excited to contribute by proposing problems for the event. In the end, I set a total of <code class="language-plaintext highlighter-rouge">six problems</code>, with crux ideas for two out of those six challenges. All the cryptography problems can be found <a href="https://github.com/MmukulKhedekar/BackdoorCTF2023-Crypto">here</a>. I personally found <a href="https://connor-mccartney.github.io/cryptography/other/BackdoorCTF-2023-writeups">this</a> writeup to be really cool and concise.</p>

<p>I’ll quickly explain a background of how i came up with these problems and a sketch of how to solve them.</p>

<h2 id="mini_rsa_v1-310-solves">mini_RSA_v1 [310 solves]</h2>

<p>I proposed the idea for this problem. It was scripted by my peer. We initially wanted to make a problem revolving around the cool identity</p>

\[p ^ q + q ^ p \equiv p + q \pmod{pq}\]

<p>but then we realised that this problem had already appeared in contest earlier this year, so we had to scrap that. I realised that infact for any integers \(a\) and \(b\), it holds that,</p>

\[p^{\left( q^a\right)} + q^{\left( p^b\right)} \equiv p + q \pmod{pq}\]

<p>and hence the problem.</p>

<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=mini_rsa_v1.py"> </script>
</div>

<h2 id="mini_rsa_v2-77-solves">mini_RSA_v2 [77 solves]</h2>

<p>I kinda overlooked the small size of the public exponent <code class="language-plaintext highlighter-rouge">e</code> in the RSA encryption that lead to the unintended small exponent attack on the problem. since that wasn’t the intended solve, we rolled out the ver2 of the problem with a larger public exponent (<code class="language-plaintext highlighter-rouge">e = 65537</code>). Now the intended way to solve this calculate the euler totient function of the public modulus using the extra leaked info (<code class="language-plaintext highlighter-rouge">s + t = p + q</code>).</p>

<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=mini_rsa_v2.py"> </script>
</div>

<h2 id="prsa-70-solves">PRSA [70 solves]</h2>

<p>I know this was a kinda popular/textbook problem. There are lots of texts and implementations based on RSA on polynomial rings that you can find with a single google search. Nevertheless, I wanted it to be an introductory “sage” based problem, so I let it slip anyway.</p>

<p>A quick description of the challenge would be the textbook RSA problem but instead on polynomial rings instead of the ring of two coprime primes. The intended way to solve this was to factor the public modulus polynomial into two irreducible polynomials in the given polynomial ring and evaluate the euler totient using</p>

\[\mid \mathbb{F}[x]^{\star} / \left(P_1(x) P_2(x)\right) \mid = \mid \mathbb{F}[x]^{\star} / P_1(x) \times \mathbb{F}[x]^{\star} / P_2(x) \mid\]

\[= \left(2 ^{\text{deg} \left(P_1(x) \right)} - 1 \right) \times \left(2 ^{\text{deg} \left(P_2(x) \right)} - 1 \right)\]

<p>then using the euler totient, we calculate the private exponent and decrypt the message.</p>

<p>There was an unintended solve, where you brute force over the degree of the polynomials to reverse engineer the original polynomial degree (since the degrees were small). I had realised that there could be this unintended solve when I wrote this challenge, but I let it slip since I wanted this to be more about reading and writing sage codes.</p>

<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=prsa.py"> </script>
</div>

<h2 id="rebellious-16-solves">Rebellious [16 solves]</h2>

<p>Again a straight forward DLOG based challenge, but instead of implementing the system over an elliptic curve, I chose an Ellipse. There were many approaches to this problem. The intended solution was to observe that \(p \equiv 1 \pmod{4}\). This means that imaginary numbers exist in this prime field. Now you can observe that,</p>

\[\frac{x^2}{a^2} + \frac{y^2}{b^2} \equiv \left(\frac{x}{a} + \sqrt{-1} \frac{y}{b} \right) \cdot \left(\frac{x}{a} - \sqrt{-1} \frac{y}{b} \right) \equiv 1 \pmod{p}\]

<p>If we let \(u = \left(\frac{x}{a} + \sqrt{-1} \frac{y}{b} \right)\) and \(v = \left(\frac{x}{a} - \sqrt{-1} \frac{y}{b} \right)\), it can be observed that</p>

\[v \equiv u ^ {-1} \pmod{p}\]

<p>and similarly you can show that there’s an isomorphism mapping from the given group to \(\mathbb{F}_p\) explicity given by</p>

\[\phi \left( P (x, y)\right) = \left(\frac{x}{a} + \sqrt{-1} \frac{y}{b} \right) \pmod{p}\]

<p>Now transform the problem to this prime field and solve the DLOG. I purposely chose <code class="language-plaintext highlighter-rouge">p</code> to be an unsafe prime so that people choose this approach.</p>

<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=rebellious.py"> </script>
</div>

<h2 id="secure-matrix-transmissions-20-solves">Secure Matrix Transmissions [20 solves]</h2>

<p>I was motivated by the result that the diagonal matrix in the matrix diagonalization contains the eigenvalues of the matrix and thus this challenge. I chose a small dimension <code class="language-plaintext highlighter-rouge">N = 6</code> so that this becomes the intended approach as even a naive brute would require \((N! \times N!)\) operations and thats not too much.</p>

<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=smt_v1.py"> </script>
</div>
<p><br /></p>
<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=smt_v1_intercepted_text.txt"> </script>
</div>

<h2 id="secure-matrix-transmissions-v2-1-solve">Secure Matrix Transmissions v2 [1 solve]</h2>

<p>This was system was implemented from the following <a href="https://www.degruyter.com/document/doi/10.1515/jmc.2011.010/html"> paper</a> under the heading BCFRX scheme. I really didnt want to throw challenges based off papers directly but I had no other choice since the teams on this CTF were really good at cryptography and had butchered almost all the other cryptography problems.</p>

<p>To break this system, one may implement the <code class="language-plaintext highlighter-rouge">Linear Algebra</code> attack of solving simultaneous systems of equations as described in the paper. Otherwise, as pointed out by <code class="language-plaintext highlighter-rouge">Neobeo</code> <a href="https://discord.com/channels/916568950375059476/916693278701781103/1187542230345470052">here</a> we may lift the group from \(\mathbb{F}_{p}\) to \(\mathbb{F}_{p^{10}}\) to diagonalise and solve for the shared secret as all the eigenvalues of the given matrices exist in the latter.</p>

<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=smt_v2.py"> </script>
</div>
<p><br /></p>
<div class="gist-collapsed">
<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/5e6787833ada6725449960c741994294.js?file=smt_v2_intercepted_text.txt"> </script>
</div>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2024/12/25/backdoorctf-2024/">
            BackdoorCTF 2024
            <small>25 Dec 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2024/10/15/binary-exploitation/">
            Binary Exploitation 2024
            <small>15 Oct 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2024/10/06/elf-golfing/">
            ELF Golfing
            <small>06 Oct 2024</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
