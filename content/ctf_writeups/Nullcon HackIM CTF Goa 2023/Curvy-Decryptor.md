---
linkTitle: Curvy Decryptor
title: Curvy Decryptor [Writeup]
type: docs
math: True
---
## Challenge Description

```
Alice has hidden 2 flags in this challenge. And even though she is willing to decrypt most ciphers, she has some basic saveguards against stealing flags.

Please submit flag1 here.
```

## Solution
it's easy to observe that 

$$
    c = m + B \cdot d_a
$$

We are provided with the points `c` and `B` and to receive the first flag, we'll have to retrieve the point `m`. We also have an arrangement that sends us the `x`-coordinate of the point `c - B * d_a`. We could send in `2 * c` and `2 * B` and they'll return us the `x`-coordinate of the point `2 * m`. Then, we could retrieve the point $m$ from that using sagemath. Here's the implementation

```python
from sage.all import *
from Cryptodome.Util.number import *

# Elliptic Curve parameters
p = 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff
a = -3
b = 0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b
n = 0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551
E = EllipticCurve(Zmod(p), [a,b])

G = E(0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296, 0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5)

B = E(90099139681438884609902890502719410986497907870543013656424398387900610492563, 21444449619346676035849575998271304805253255148709293121336119405905077951856)
c = E(66352599225046789366426989609382550575167780339427460520662466128234215248940, 79145928836074131645330320877947346707491948401697157805655071119445717393612)

# print(B+B)
# print(c+c)

# (46423889747054594922058675350488906208691484528810123715418038177388661249479, 77349316888408695637539425856691344712676691738864096109440661967547740809750 : 1)
# (71348775708023972037009143424101416999169363981150548500107498919238880683568, 49698371443641491375535154691280570201566276348885416658937544761774141192889 : 1)

m = int("24d9b2cb96c8c819840de912e052bfc31549d3abfc3a67c7e7aee3549575698e",16)
m = 16667902361652842058817283456146141523112408649233484459284293323592876517774

# sage: p = 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff
# sage: a = -3
# sage: b = 0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b
# sage: n = 0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551
# sage: E = EllipticCurve(GF(p), [a,b])
# sage: m = 16667902361652842058817283456146141523112408649233484459284293323592876517774
# sage: print(E.lift_x(m%p))

M = E(16667902361652842058817283456146141523112408649233484459284293323592876517774, 75475635116653411073496393466925054198245595119229497257308481229642671010680)

# print(M.division_points(2))
print(long_to_bytes(478331744150452007169656202614580135667533560163676060093785159488648061))
```
## Flag
```
ENO{ElGam4l_1s_mult1pl1cativ3}
```
