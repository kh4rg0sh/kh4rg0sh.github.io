---
layout: post
title: Binary Exploitation 2024
---

# Introduction
motivated by this blog:
> <a href="https://ptr-yudai.hatenablog.com/entry/2019/07/01/143652" target="_blank">https://ptr-yudai.hatenablog.com/entry/2019/07/01/143652</a>

i'll be attempting to do something similar. at the time of writing this doc, it's already the mid of october. there's not even 3 months left for this year to end. the goal of this challenge would be to upsolve all the pwn challenges that were introduced in alls the CTFs this year. since i'm a beginner (i started pwn seriously 2 months ago), i'll only be attempting `C/C++ pwn` and that too i'll stick to userland pwn only! the format of the challenge would be as follows: 
1. mention the name, ctftime link and the archive link of the CTF.
2. list down all the pwn category challenges in this doc.
3. attempt each challenge for about 2 to 3 hours. if there's some progress note that down. if there isn't read a writeup and whatever new knowledge you've acquired should be introduced as a blog post on your blog.
4. re-write the entire writeup in your own words. this also involves crafting the exploit script in your own style.
5. if you are not able to provide a writeup for a challenge, mention the reason.
6. an exception to not attempting a challenge would be in drastic conditions such as almost impossible to produce the environment in which the challenge was deployed, etc. 
7. every challenge should begin with a TLDR. this TLDR should mention the important techniques involved and the exploit path that you took.
8. you should also rate challenges on the scale of `1 to 10`

## Rating Scale
the difficulty rating scale that i propose here is a subject to change as per the requirements in the future. so these must be considered as tentative but the difficulty rating that i give to the problems would strictly follow whatever's mentioned here. 

1. **Difficulty = 1:** very easy braindead pwn including bandit wargame type pwn challenges that do not require any exploitation knowledge apart from being able to use linux.
2. **Difficulty = 2 - 4:** ranging from trivial programming errors such as integer overflow, buffer overflow to writing trivial ROP chains and format string vulnerabilities to perform ret2win, ret2system, etc.
3. **Difficulty = 5 - 6:** Intermediate tasks such as partial overwrite of GOT/PLT entries and other techniques such as ret2csu, ret2dlresolve, etc.
4. **Difficulty = 7 - 8:** From SROP and introductory heap challenges to FSOP and targetting complex structures in the binary
5. **Difficulty = 9 - 10:** Challenges that are basically completely out of my league.

---
# IrisCTF [6th Jan, 2024]
> ctftime link: <a href="https://ctftime.org/event/2085" target="_blank">https://ctftime.org/event/2085</a><br>
> archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/IrisCTF/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/IrisCTF/2024/pwn</a>

* comments: overall very nice challenges. loved these. 
## Insanity-Check
* ### Difficulty: 2/10
```
summary: ret2win just get the right offsets and the printed message aligns with the target.
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/insanity-check" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/insanity-check</a>


* comments: the problem is kinda dumb imo, but this problem showcases an interesting aspect to challenge authors pertaining to crafting custom addresses for functions. i wonder how did they manage to do this.
```c 
__attribute__((section(".flag")))
void win() {
    __asm__("pop %rdi");
    system("cat /flag");
}
```
believe it or not, this `win()` function is at a very funny memory address `0x6d6f632e` which translates to `.com` in little endian. 


## Serious Banking
* ### Difficulty: 5/10 
```
summary: `C++ pwn` with signed char negative indexing leveraging to a format string vulnerability to leak libc address and then `ret2system`.
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/serious-banking" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/serious-banking</a>

* comments: i expected this challenge to be based on some `C++ STL` vulnerability. however, it turns out that the vulnerability was the usage of `signed char` in indexing. nevertheless, this is still an interesting challenge. this is the second time im witnessing brutally ripping off program control flow due to a mere `signed char` indexing. 

also i found the path to `ret2system` kinda innovative in this problem. the stack frame deallocation assembly looked somewhat like 

```asm
0x0000000000001812 <+1426>:  add    rsp,0x38
0x0000000000001816 <+1430>:  pop    rbx
0x0000000000001817 <+1431>:  pop    r12
0x0000000000001819 <+1433>:  pop    r13
0x000000000000181b <+1435>:  pop    r14
0x000000000000181d <+1437>:  pop    r15
0x000000000000181f <+1439>:  pop    rbp
0x0000000000001820 <+1440>:  ret
```
so instead of `pop rdi; <bin_sh>; system;` i did `mov rdi, r12; call rbx;` and since we already control the `r12` and `rbx` register, this still paves its way to `ret2system`.


## Memory [Not Solved]
a `kernel` pwn. im not attempting these right now.

## Sequilitis [Not Solved]
this challenge is related to `sqlite3` pwning. im not attempting this right now.

---
# UofTCTF [13th Jan, 2024]
> ctftime link: <a href="https://ctftime.org/event/2219" target="_blank">https://ctftime.org/event/2219</a><br>
> archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/UofTCTF/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/UofTCTF/2024/pwn</a>

## Basic Overflow 
* ### Difficulty: 1/10
```
summary: simple ret2win
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/basic_overflow" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/basic_overflow</a>

* comments: this is too stupid to be a CTF challenge. hate this. 

## Baby Shellcode
* ### Difficulty: 1/10
```
summary: read into the stack and `jmp, rsp`. write a trivial shellcode.
``` 

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/baby_shellcode" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/baby_shellcode</a>

* comments: a really dumb challenge. i regret solving this.

## Patched Shell
* ### Difficulty: 2/10
```
summary: ret2win with stack misalignment
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/patched_shell" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/patched_shell</a>

* comments: too standard to be a CTF challenge in my opinion.

## Nothing to Return 
* ### Difficulty: 2/10 
```
summary: straightforward ret2system
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/nothing_to_return" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/nothing_to_return</a>

* comments: again too straightforward. overall i feel like the pwn challenges in this CTF are just too dumb. what a waste of time.

---
# HKUST Firebird CTF [20th Jan, 2024]
> ctftime link: <a href="https://ctftime.org/event/2225" target="_blank">https://ctftime.org/event/2225</a><br>
> archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/HKUSTFirebird/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/HKUSTFirebird/2024/pwn</a><br>
> website: <a href="https://ash.firebird.sh/challenges" target="_blank">https://ash.firebird.sh/challenges</a>

* comments: overall high quality challenges. totally recommended to solve!
## MoonBlast
* ### Difficulty: 3/10

```
summary: rand() simulation. ROP to obtain a libc leak via `puts(GOT[puts])` then ret2system
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/MoonBlast" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/MoonBlast</a>

* comments: i liked the part of having to write a local program that would generate the right passcode to pass the protection. apart from that, this was a pretty standard libc leak via ropping and abusing the PLT entries to ret2system. pretty standard.

## MercuryBlast
* ### Difficulty: 6/10

```
summary: UAF + heapoverflow => tcache poisoning and overwrite `__free_hook`.
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/MercuryBlast" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/MercuryBlast</a>

* comments: awesome challenge! this was fun. this was the first time i performed a `tcache poisoning` attack without any external help. the vulnerability was evident, but it was a great learning experience. recommended challenge for introductory heap exploitation! i, myself, learnt a couple of things while playing around devising strategies to attack this program.

## mpi [Unsolved]
attempting: no clue yet

## unsetenv [Unsolved]
attempting: no clue yet

## UwUOF+++ Super ARM Deluxe Edition [Not Solved]
ARM binary. not pwning different target architecture binaries right now atleast. save these for the future. 

## trim [Not Solved]
this is a lua pwn challenge. currently, im not dealing with these types of challenges. save these for the future.

---

# Insomni'Hack Teaser [20th Jan, 2024]
> ctftime link: <a href="https://ctftime.org/event/2139" target="_blank">https://ctftime.org/event/2139</a><br>
> archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/insomnihack/2024/Quals/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/insomnihack/2024/Quals/pwn</a>

comments: okayish challenges.

## Vaulty
* ### Difficulty = 3/10

```
summary: format string and buffer overflow => obtain libc leak, elf leak and canary leak => ROP to ret2system
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/Vaulty" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/Vaulty</a>

* comments: pretty standard challenge that exploits format string vulnerability. didn't learn anything new tbh. recommended to beginners, however!

## Tinderbox [Not Solved]
wasm pwn challenge. wont be solving this now. ill save this up for future when i touch browser pwn.

---
# Mapna CTF [20th Jan, 2024]
> ctftime link: <a href="https://ctftime.org/event/2205" target="_blank">https://ctftime.org/event/2205</a><br>
> archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/Mapna/2024/pwn" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/Mapna/2024/pwn</a>

## ninipwn
* ### Difficulty: 3/10

```
summary: global variable overflow + format string bug => ret2win
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/ninipwn" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/ninipwn</a>

* comments: kinda creative problem. i found out the format string bug. it was very evident to be honest however that kinda lead me in the wrong direction. i was trying to somehow overwrite the last byte of the return address using the format string but it felt impossible. that's when i noticed there was another bug, the overflow in the global variables in the data section. that was kinda unexpected and creative. nice challenge.

## Buggy Paint 
* ### Difficulty: 7/10

```
summary: Use After Free => leak heap, libc and stack => tcache poisoning to obtain arbitary read and write => ROP chain on the stack to perform ret2system
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/Buggy_Paint" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/Buggy_Paint</a>

* comments: awesome challenge! the challenge premise didn't feel forced for a pwning challenge. with all the security mitigations enabled and a fully functional paint application, the bug (use after free) in the program did not feel intentional. very realistic premise, a bug that a novice programmer would definitely commit. 

also this was the first time i exploited a heap challenge that used the `libc ver. 2.35`. so this was very educational. also i believe that there are other exploitation paths to exploit this program as well. i read a writeup that involved FSOP. so that's something id like to look into the future. 

overall a recommended challenge for heap exploitation novices who want familiarity with exploiting programs in `libc 2.35`

## Protector [Unsolved]
trying to think of an exploit. right now, the only thing i can think of is ORW using ROP. but my ROP chain is longer than what they per

## U2S [Not Solved]
this is a `lua` pwn challenge. ill do these later. leaving this challenge for now, not attempting.

---

# 0xL4ugh CTF [9th Feb, 2024]
> ctftime link: <a href="https://ctftime.org/event/2216" target="_blank">https://ctftime.org/event/2216</a></br>
> archive link: <a href="https://github.com/sajjadium/ctf-archives/tree/main/ctfs/0xL4ugh/2024/pwn/pwn1" target="_blank">https://github.com/sajjadium/ctf-archives/tree/main/ctfs/0xL4ugh/2024/pwn/pwn1</a>

comments: only 1 pwn challenge on this ctf. cakewalk challenge honestly.

## pwn1
* ### Difficulty: 4/10

```
summary: UAF => tcache poisoning to overwrite free_hook with system
```

> writeup link: <a href="https://github.com/kh4rg0sh/project-2024/tree/main/pwn1" target="_blank">https://github.com/kh4rg0sh/project-2024/tree/main/pwn1</a>

* comments: pretty standard challenge and in my opinion, a very poorly written challenge. even though, im suppose to be rating heap challenges atleast a `6/10` but this challenge felt pretty stupid. i dont know if it's either the challenge's fault or if i'm getting better, but this was really straightforward. i've performed `tcache poisoning` on `libc 2.31` in a very similar setup (or maybe a bit more constrained setting) as this challenge so this didn't feel difficult at all. hence, i'm rating this `4/10`. what a no brainer!

---